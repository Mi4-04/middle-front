(self.webpackChunkmiddle_front=self.webpackChunkmiddle_front||[]).push([[792],{48855:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,n:()=>d});var r=n(9211);class l{constructor(e){this.key=e}is(e){var t;let n=(t=e,(0,r.Mn)(t)&&t.graphQLErrors?t.graphQLErrors.reduce((e,t)=>{var n;let r=null===(n=t.extensions)||void 0===n?void 0:n.exception;return"string"==typeof(null==r?void 0:r.key)&&e.push(r.key),e},[]):[]);return n.some(e=>e===this.key)}}let s=new l("AUTH_TOKEN_ERROR");let i=new l("TOKEN_OUTDATED_ERROR");let o=new l("USER_ALREADY_EXIST_ERROR");let a=new l("USER_NOT_FOUND_ERROR");let c=new l("INCORRECT_PASSWORD_ERROR");let u={InvalidAuthToken:s,AuthTokenExpired:i,UserAlreadyExist:o,UserNotFound:a,IncorrectPassword:c};function d(e){return e instanceof Error&&(0,r.Mn)(e)&&e.networkError?"Network error. Please contact support.":"Server error. Something went wrong."}},36340:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(96540);var l=n(81959);function s(){return(0,r.useContext)(l.A)}},95697:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(96540);var l=n(88913);function s(){return(0,r.useContext)(l.A)}},15244:(e,t,n)=>{n.nc="N2XEmPk5cXSIscqX4xydtA=="},44866:(e,t,n)=>{"use strict";n(83142),n(16280),n(30067),n(4294),n(18107),n(10838),n(13451),n(44114),n(93514),n(30237),n(13609),n(78347),n(96167),n(93518),n(9391),n(15472),n(69479),n(67357),n(28543),n(25440),n(79978),n(34594),n(29833),n(46594),n(72107),n(95477),n(21489),n(22134),n(3690),n(61740),n(48140),n(75044),n(21903),n(91134),n(48345),n(52568),n(28845),n(373),n(62953),n(64979),n(59848),n(71678),n(3296),n(27208),n(48408)},5331:(e,t,n)=>{"use strict";var r=n(96540);var l=n(5338);var s=n(84976);var i=n(27962);var o=n(75273);var a=n(98008);var c=n(27404);var u=n(28797);var d=n(82081);var h=n(48855);var x=n(27380);let v=(0,x.A)();let p=(0,d.S)(e=>{let t=h.A.InvalidAuthToken.is(e)||h.A.AuthTokenExpired.is(e);t&&(e.response&&(e.response.errors=void 0),v.emit("signOut"))});var f=n(74848);let m=new i.P({uri:"http://nest-app.local:4300/graphql",credentials:"include"});let j=new o.R({link:(0,a.x)(p,m),cache:new c.D,defaultOptions:{watchQuery:{fetchPolicy:"cache-and-network"}}});function y({children:e}){return(0,f.jsx)(u.X,{client:j,children:e})}var A=n(88913);function g({children:e}){let[t,n]=(0,r.useState)([]);let[l,s]=(0,r.useState)(null);let[i,o]=(0,r.useState)({});let a=(0,r.createRef)();return(0,f.jsx)(A.A.Provider,{value:{tracks:t,setTracks:n,trackIndex:l,setTrackIndex:e=>{var n;null!==l&&null!==(n=t[l])&&void 0!==n&&n.id&&o(e=>({...e,[t[l].realId]:!1})),s(e)},trackStates:i,setTrackState:(e,t)=>{o(()=>({[e]:t}))},audioRef:a},children:e})}var k=n(39708);var w=n(39181);let C;let E={};let S=(0,k.J1)(C||(C=(e=>e)`
    query CurrentUser {
  currentUser {
    id
    email
  }
}
    `));function R(e){let t={...E,...e};return Apollo.useLazyQuery(S,t)}function O(e){let t={...E,...e};return Apollo.useSuspenseQuery(S,t)}var F=n(81959);var _;function b({children:e}){var t;let{data:n,loading:r,refetch:l}=function(e){let t={...E};return w.I(S,t)}();let s=null!==(t=null==n?void 0:n.currentUser)&&void 0!==t?t:null;if(r)return _||(_=(0,f.jsx)("h2",{children:"loading..."}));let i=async()=>{await l().catch(()=>void 0)};return(0,f.jsx)(F.A.Provider,{value:{currentUser:s,refetch:i},children:e})}var q=n(47767);var T=n(36340);var I=n(97834);var P=n(89828);var L=n(8532);var U=n(14073);var z=n(69067);var D=n(86990);var M=n(54409);var N=n(95697);var G=n(59580);n(52223);var Q=n(85738);let B=Q.I4.div.withConfig({componentId:"sc-qqpevs-0"})(["display:flex;align-items:center;gap:20px;"]);let X=Q.I4.img.withConfig({componentId:"sc-qqpevs-1"})(["width:60px;height:60px;"]);let H=Q.I4.div.withConfig({componentId:"sc-qqpevs-2"})(["flex-direction:column;text-align:start;"]);function K(){var e,t;let{audioRef:n,tracks:r,trackIndex:l,setTrackIndex:s,setTrackState:i}=(0,N.A)();if(0===r.length||null==l)return null;let{name:o,audioUrl:a,realId:c,artist:u,imageUrl:d}=r[l];let h=()=>{l<r.length-1?s(l+1):s(0)};return(0,f.jsx)(G.A,{ref:n,src:a,hasDefaultKeyBindings:!0,showSkipControls:!0,autoPlay:!0,onPause:()=>i(c,!1),onPlay:()=>i(c,!0),onClickNext:h,onClickPrevious:()=>{l-1<0?s(r.length-1):s(l-1)},onEnded:()=>{r.length>0&&h()},header:(0,f.jsxs)(B,{children:[null!=d?e||(e=(0,f.jsx)(X,{src:d,alt:"image"})):null,(0,f.jsxs)(H,{children:[t||(t=(0,f.jsx)("p",{children:o})),(0,f.jsx)("p",{children:null!=u?u:"Unknown"})]})]}),style:{position:"fixed",bottom:0,left:20,maxWidth:"450px",width:"100%",zIndex:2}})}var J=n(95420);let W;let Z={};let V=(0,k.J1)(W||(W=(e=>e)`
    mutation SignOut {
  signOut {
    currentUser {
      id
      email
    }
  }
}
    `));var Y;function $({children:e}){let t=(0,q.Zp)();let[n,{loading:r}]=function(e){let t={...Z};return J.n(V,t)}();let l=async()=>{if(!r)try{await n(),v.emit("signOut"),t("/sign-in")}catch(e){(0,M.P)((0,h.n)(e),{type:"error",autoClose:!1})}};return(0,f.jsxs)(I.A,{sx:{width:"100%"},children:[(0,f.jsx)(P.A,{component:"nav",children:(0,f.jsxs)(L.A,{children:[(0,f.jsx)(U.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block",cursor:"pointer"}},onClick:()=>t("/home"),children:"Music"}),(0,f.jsxs)(z.A,{sx:{display:"flex",gap:"3rem"},children:[(0,f.jsx)(U.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block",cursor:"pointer"}},onClick:()=>t("/search"),children:"Search track"}),(0,f.jsx)(U.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block",cursor:"pointer"}},onClick:()=>t("/my-playlists"),children:"My playlists"}),(0,f.jsx)("div",{children:(0,f.jsx)(D.A,{sx:{color:"#fff"},onClick:l,children:"Sign out"})})]})]})}),(0,f.jsxs)(I.A,{sx:{mt:10,position:"relative"},children:[e," ",Y||(Y=(0,f.jsx)(K,{}))]})]})}var ee;function et({children:e}){let t=(0,q.Zp)();return(0,f.jsxs)(I.A,{sx:{width:"100%"},children:[(0,f.jsx)(P.A,{component:"nav",children:(0,f.jsxs)(L.A,{children:[(0,f.jsx)(U.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block",cursor:"pointer"}},onClick:()=>t("/home"),children:"Music"}),(0,f.jsxs)(z.A,{sx:{display:"flex",gap:"3rem"},children:[(0,f.jsx)(U.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block",cursor:"pointer"}},onClick:()=>t("/search"),children:"Search track"}),(0,f.jsxs)(z.A,{children:[(0,f.jsx)(D.A,{sx:{color:"#fff"},onClick:()=>t("/sign-up"),children:"Sign up"}),(0,f.jsx)(D.A,{sx:{color:"#fff"},onClick:()=>t("/sign-in"),children:"Login"})]})]})]})}),(0,f.jsxs)(I.A,{sx:{mt:10,position:"relative"},children:[e," ",ee||(ee=(0,f.jsx)(K,{}))]})]})}function en({children:e}){let{currentUser:t}=(0,T.A)();return(0,f.jsx)(null!=t?$:et,{children:e})}var er;function el(e){let{children:t,element:n,component:l}=e;let{currentUser:s}=(0,T.A)();return null!=s?t?(0,f.jsx)(f.Fragment,{children:t}):n||(l?(0,r.createElement)(l):null):er||(er=(0,f.jsx)(q.C5,{to:"/sign-in"}))}var es;let ei=(0,r.lazy)(async()=>n.e(586).then(n.bind(n,36586)));let eo=(0,r.lazy)(async()=>Promise.all([n.e(126),n.e(971),n.e(142)]).then(n.bind(n,22142)));let ea=(0,r.lazy)(async()=>Promise.all([n.e(126),n.e(971),n.e(699)]).then(n.bind(n,23699)));let ec=(0,r.lazy)(async()=>n.e(502).then(n.bind(n,55502)));let eu=(0,r.lazy)(async()=>Promise.all([n.e(374),n.e(306),n.e(463)]).then(n.bind(n,25463)));function ed(){return es||(es=(0,f.jsx)(en,{children:(0,f.jsx)(r.Suspense,{fallback:(0,f.jsx)("h1",{children:"Loading..."}),children:(0,f.jsx)(q.BV,{children:(0,f.jsxs)(q.qh,{path:"/",children:[(0,f.jsx)(q.qh,{index:!0,element:(0,f.jsx)(q.C5,{to:"/home"})}),(0,f.jsx)(q.qh,{path:"/home/*",element:(0,f.jsx)(ei,{})}),(0,f.jsx)(q.qh,{path:"/sign-up",element:(0,f.jsx)(eo,{})}),(0,f.jsx)(q.qh,{path:"/sign-in",element:(0,f.jsx)(ea,{})}),(0,f.jsx)(q.qh,{path:"/search",element:(0,f.jsx)(eu,{})}),(0,f.jsx)(q.qh,{path:"/my-playlists/*",element:(0,f.jsx)(el,{element:(0,f.jsx)(ec,{})})}),(0,f.jsx)(q.qh,{path:"*",element:(0,f.jsx)(q.C5,{to:"/home"})})]})})})}))}var eh=n(70111);function ex(){let e=(0,eh.m)();return(0,r.useEffect)(()=>{let t=async()=>{let t=e.readQuery({query:S});null!=t&&(e.writeQuery({query:S,data:{currentUser:null}}),await e.clearStore())};return v.on("signOut",t),()=>{v.off("signOut",t)}},[e]),null}function ev(e){var t;return null!==(t=null==e?void 0:e.matches)&&void 0!==t&&t}var ep=n(99571);n(83967);var ef=n(93409);let em=(0,Q.Ay)(ep.N9).withConfig({componentId:"sc-zf10nu-0"})(["&.Toastify__toast-container{font-weight:500;font-size:16px;line-height:120%;border-radius:10px;padding:8px 16px;& .Toastify__toast--info{color:",";background-color:",";}& .Toastify__toast--error{color:",";background-color:",";}}"],ef.xE,ef.GL,ef.sl,ef.z1);function ej(){let e=function(e){let t=(0,r.useMemo)(()=>window.matchMedia(`(${e})`),[e]);let[n,l]=(0,r.useState)(()=>ev(t));return(0,r.useEffect)(()=>{if(l(ev(t)),!t)return;let e=()=>{l(ev(t))};return"function"==typeof t.addEventListener?(t.addEventListener("change",e),()=>{t.removeEventListener("change",e)}):(t.addListener(e),()=>{t.removeListener(e)})},[t]),n}("max-width: 599px");return(0,f.jsx)(em,{limit:e?3:5})}var ey;let eA=document.body.querySelector("#app");if(null==eA||!(eA instanceof HTMLElement))throw TypeError("application root element is not found");(async function e(e,t){let n=(0,l.H)(t);return n.render(e),{unmount(){n.unmount()}}})((0,f.jsx)(r.StrictMode,{children:(0,f.jsx)(s.Kd,{children:(0,f.jsx)(function(){return(0,f.jsx)(f.Fragment,{children:ey||(ey=(0,f.jsx)(y,{children:(0,f.jsxs)(g,{children:[(0,f.jsx)(ex,{}),(0,f.jsx)(ej,{}),(0,f.jsx)(b,{children:(0,f.jsx)(ed,{})})]})}))})},{})})}),eA).catch(console.error)},88913:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(96540);let l=(0,r.createContext)({tracks:[],setTracks:()=>{},trackIndex:null,setTrackIndex:()=>{},trackStates:{},setTrackState:()=>{}});let s=l},81959:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(96540);let l=(0,r.createContext)({currentUser:null,refetch:()=>{throw Error("Form context cannot be used outside its provider.")}});let s=l},93409:(e,t,n)=>{"use strict";n.d(t,{GA:()=>u,GL:()=>l,_F:()=>i,c:()=>r,c3:()=>d,sl:()=>s,xE:()=>c,yy:()=>o,z1:()=>a});let r="#FFFFFF";let l="#ECEAFF";let s="#A73725";let i="#757A85";let o="#AFAFBB";let a="#FFDFDF";let c="#0c66d3";let u="#C2CFDF";let d="#35353D"},54409:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var r=n(99571);let l={type:"info",position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,closeButton:!1,pauseOnHover:!0,icon:!1};let s=(e,t)=>{(0,r.oR)(e,{...l,...t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[894],()=>(t(15244),t(44866),t(5331))),e.O()}]);